<!-- Firebase modular SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
  import { getFirestore, collection, addDoc, deleteDoc, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

  // 1️⃣ Firebase-Konfiguration
  const firebaseConfig = {
    apiKey: "AIzaSyAZ-_7KekhRyOrCqzdK1-4JOwlqtIrAeuQ",
    authDomain: "liste-j.firebaseapp.com",
    projectId: "liste-j",
    storageBucket: "liste-j.firebasestorage.app",
    messagingSenderId: "950349344673",
    appId: "1:950349344673:web:707c157b50e02592ea65e0"
  };

  // 2️⃣ Firebase initialisieren
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const listCollection = collection(db, "lists");

  // 3️⃣ addItem-Funktion
  window.addItem = async function() {
    const person = document.getElementById("person").value;
    const title = document.getElementById("title").value;
    const link = document.getElementById("link").value;
    if (!title || !link) return;

    await addDoc(listCollection, { person, title, link });

    document.getElementById("title").value = "";
    document.getElementById("link").value = "";
  };

  // 4️⃣ render-Funktion
  function render(snapshot) {
    const container = document.getElementById("lists");
    container.innerHTML = "";

    snapshot.forEach((docSnap) => {
      const item = docSnap.data();
      const id = docSnap.id;

      const div = document.createElement("div");
      div.className = "item";

      div.innerHTML = `
        <a href="${item.link}" target="_blank">${item.title}</a> – ${item.person}
        <button class="deleteBtn">✕</button>
      `;

      div.querySelector(".deleteBtn").onclick = async () => {
        await deleteDoc(doc(db, "lists", id));
      };

      container.appendChild(div);
    });
  }

  // 5️⃣ Echtzeit-Updates
  onSnapshot(listCollection, render);

</script>
